<!DOCTYPE html>
<html>
<head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Marvel&family=Open+Sans&family=Poppins&display=swap" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/style.css') }}">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    
  
    <body>

    <script>


function download(){

// API endpoint
const apiUrl = "http://127.0.0.1:5000/download"

console.log(apiUrl)
// Make a POST request
fetch(apiUrl, {
method: 'GET',
headers: {
'Content-Type': 'application/json',
// Add any other headers if needed
}})
.then(response => {
if (!response.ok) {
throw new Error(`HTTP error! Status: ${response.status}`);
}
return response.json();
})
.then(data => {
// Handle the API response
console.log(data);
})
.catch(error => {
console.error('Error:', error);
});

}
      
        
          setInterval(updateProgress, 4000);
          
        var count=3
        
        function updateProgress() {
          var myArray = ['Loading data', 'Cleaning data','Preparing data','Model Prediction',];
          // Get the current progress value
          var progressBar = document.getElementById('progress');
          var progressText = document.getElementById('progress-text');
        
         
        
          // Increment the progress by 25%
          var currentProgress = parseInt(progressBar.style.width) || 0;
          if(currentProgress==100){
            var newProgress=100;
          } else{
            var newProgress = currentProgress + 25;
          }
         
          if(count!=0){
            count=count-1
          }else{
            count=0
          }
          
        console.log('yes')
          // Update the progress bar and text
          progressBar.style.width = newProgress + '%';
          progressBar.setAttribute('aria-valuenow', newProgress);
          
        
          progressText.textContent = myArray[(newProgress/25)-1];
        }
        
            </script>

<div id="header">
    <div id="logo"></div> 
    <div><a href="{{ url_for('index') }}">Home</a></div>
    
     
   
   </div>

<div class="container py-5">
<h1 class="text-center py-2">Working on your data</h1>
<img class="d-block mx-auto mb-4" src="{{ url_for('static', filename='img/working.svg') }}" alt="" width="200" height="300">


<div class="progress">
    <div id='progress' class="progress-bar progress-bar-striped bg-danger" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
  </div>
    <div class="text-center"><h6 id="progress-text" calss="text-center p-2"></h6></div>
    <div class='row text-center py-5'>
        <div class='col-4'><a href="{{ url_for('download_page') }}"><input type="button" class="btn btn-danger" value='Download Results'></div></a>
        <div class='col-4'></div>
        <div class='col-4'><a href="/dashboard"><button type="button" class="btn btn-danger">See Analytics</button></div></a>
    </div>
</div>





<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

</body>
</html>


